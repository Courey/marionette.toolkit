!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("backbone.marionette"),require("backbone"),require("underscore")):"function"==typeof define&&define.amd?define(["backbone.marionette","backbone","underscore"],e):t.Toolkit=e(t.Marionette,t.Backbone,t._)}(this,function(t,e,i){"use strict";var s=t.Object.extend({StateModel:e.Model,constructor:function(e){e=e||{};var i=e.StateModel||this.StateModel;this._stateModel=new i,this.bindEntityEvents(this._stateModel,this.getOption("stateEvents")),t.Object.call(this,e)},setState:function(){return this._stateModel.set.apply(this._stateModel,arguments)},getState:function(t){return t?this._stateModel.get.apply(this._stateModel,arguments):this._stateModel},destroy:function(){this._stateModel.stopListening(),t.Object.prototype.destroy.apply(this,arguments)}}),n=s.extend({constructor:function(t){i.bindAll(this,"start","stop"),this._apps={},i.extend(this,i.pick(t,["startWithParent","stopWithParent","apps"])),this.addApps(this.getOption("apps")),this._initializeApps(),s.call(this,t)},_isRunning:!1,_isDestroyed:!1,startWithParent:!1,stopWithParent:!0,_ensureSubappIsIntact:function(){if(this._isDestroyed)throw new t.Error({name:"SubappDestroyedError",message:"Subapp has already been destroyed and cannot be used."})},start:function(t){this._ensureSubappIsIntact(),this._isRunning||(this.triggerMethod("before:start",t),this._isRunning=!0,this.startApps(),this.triggerMethod("start",t))},stop:function(t){this._isRunning&&(this.triggerMethod("before:stop",t),this._isRunning=!1,this.stopApps(),this.triggerMethod("stop",t))},addApp:function(t,e,i){var s=this._apps[t]=new e(i);return this._isRunning&&s.getOption("startWithParent")&&s.start(),s},getApp:function(t){return this._apps[t]},destroyApp:function(t){i.isString(t)&&(t=this.getApp(t)),t&&t.destroy()},addApps:function(t){i.each(t,function(t,e){this.addApp(e,t)})},_initializeApps:function(){},startApps:function(){},stopApps:function(){i.each(this._apps,this.stopApp)},isRunning:function(){return this._isRunning},isDestroyed:function(){return this._isDestroyed},destroy:function(){this.stop(),this.destroyApps(),this._isDestroyed=!0,s.prototype.destroy.apply(this,arguments)}}),o=s.extend({constructor:function(e,s){s=s||{},i.extend(this,i.pick(s,["viewEventPrefix","viewClass","viewOptions","region"])),t.StateObject.call(this,s),this._setStateDefaults(e)},_shouldDestroy:!0,_setStateDefaults:function(t){i.defaults(t,i.result(this,"defaults")),this.setState(t,{silent:!0})},viewEventPrefix:"view",viewClass:t.ItemView,viewOptions:{},showIn:function(t){t&&(this.region=t),this.show()},show:function(){if(this._isShown)throw new t.Error({name:"ComponentShowError",message:"Component has already been shown in a region."});if(!this.region)throw new t.Error({name:"ComponentRegionError",message:"Component has no defined region."});this.listenTo(this.region,"empty",this.destroy),this.triggerMethod("before:show"),this.renderView(),this._isShown=!0,this.triggerMethod("show")},renderView:function(){this.view=this.buildView(),this._proxyViewEvents(),this.triggerMethod("before:render:view",this.view),this._shouldDestroy=!1,this.region.show(this.view),this._shouldDestroy=!0,this.triggerMethod("render:view",this.view)},_proxyViewEvents:function(){var t=this.getOption("viewEventPrefix");this.view.on("all",function(){var e=i.toArray(arguments),s=e[0];e[0]=t+":"+s,e.splice(1,0,this.view),this.triggerMethod.apply(this,e)},this)},mixinOptions:function(t){return i.extend({model:this.getState()},this.viewOptions,t)},buildView:function(){return new this.viewClass(this.mixinOptions())},_destroy:function(){t.StateObject.prototype.destroy.apply(this,arguments),this.region.empty()},destroy:function(){return this._shouldDestroy&&this._destroy(),this}}),r=t.Toolkit={};r.StateClass=s,r.Subapp=n,r.Component=o;var h=r;return h});
//# sourceMappingURL=marionette.toolkit.min.js.map