{"version":3,"sources":["marionette.toolkit.js"],"names":[],"mappings":"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","file":"marionette.toolkit.js","sourcesContent":["/**\n * marionette.toolkit - StateClass, App, and Component.\n * @version v0.1.0\n * @link https://github.com/RoundingWellOS/marionette.toolkit\n * @license MIT\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('backbone.marionette'), require('backbone'), require('underscore')) :\n  typeof define === 'function' && define.amd ? define(['backbone.marionette', 'backbone', 'underscore'], factory) :\n  factory(global.Marionette, global.Backbone, global._)\n}(this, function (Marionette, Backbone, _) { 'use strict';\n\n  var StateClass = Marionette.Object.extend({\n\n    /**\n     * The model class for _stateModel.\n     * @type {Backbone.Model}\n     */\n    StateModel: Backbone.Model,\n\n    /**\n     * @public\n     * @constructs StateClass\n     * @param {Object} [options] - Settings for the stateClass.\n     * @param {Object} [options.stateEvents] - Event hash bound from _stateModel to stateClass.\n     * @param {Object} [options.StateModel] - Model class for _stateModel.\n     */\n    constructor: function(options){\n      options = options || {};\n\n      // Get the StateModel from options or the class definition\n      var StateModel = options.StateModel || this.StateModel;\n\n      this._stateModel = new StateModel();\n\n      // Bind events from the _stateModel defined in stateEvents hash\n      this.bindEntityEvents(this._stateModel, this.getOption('stateEvents'));\n\n      Marionette.Object.call(this, options);\n    },\n\n    /**\n     * Set a property on the _stateModel.\n     *\n     * @public\n     * @method setState\n     * @memberOf StateClass\n     * @param {String|Object} key - Attribute name or Hash of any number of key value pairs.\n     * @param {*=} value - Attribute value if key is String, replaces options param otherwise.\n     * @param {Object=} options - Backbone.Model options.\n     * @returns {Backbone.Model} - The _stateModel\n     */\n    setState: function(){\n      return this._stateModel.set.apply(this._stateModel, arguments);\n    },\n\n    /**\n     * Get a property from the _stateModel, or return the _stateModel\n     *\n     * @public\n     * @method getState\n     * @memberOf StateClass\n     * @param {String=} attr - Attribute name of stateModel.\n     * @returns {Backbone.Model|*} - The _stateModel or the attribute value of the _stateModel\n     */\n    getState: function(attr){\n      if(!attr) {\n        return this._stateModel;\n      }\n\n      return this._stateModel.get.apply(this._stateModel, arguments);\n    },\n\n    /**\n     * Destroy the stateClass and clean up any listeners on the _stateModel.\n     *\n     * @public\n     * @method destroy\n     * @memberOf StateClass\n     */\n    destroy: function(){\n      this._stateModel.stopListening();\n\n      Marionette.Object.prototype.destroy.apply(this, arguments);\n    }\n  });\n\n  var App = StateClass.extend({\n\n    constructor: function(options) {\n      options = options || {};\n\n      _.bindAll(this, 'start', 'stop');\n\n      this._apps = {};\n\n      _.extend(this, _.pick(options, ['startWithParent', 'stopWithParent', 'apps']));\n\n      // Initialize apps\n      this.addApps(this.getOption('apps'));\n\n      StateClass.call(this, options);\n    },\n\n    _isRunning: false,\n\n    _isDestroyed: false,\n\n    startWithParent: false,\n\n    stopWithParent: true,\n\n    _ensureAppIsIntact: function() {\n      if(this._isDestroyed) {\n        throw new Marionette.Error({\n          name: 'AppDestroyedError',\n          message: 'App has already been destroyed and cannot be used.'\n        });\n      }\n    },\n\n    start: function(options) {\n      this._ensureAppIsIntact();\n\n      if(this._isRunning) {\n        return;\n      }\n\n      this.triggerMethod('before:start', options);\n\n      this._isRunning = true;\n      this.startApps();\n\n      this.triggerMethod('start', options);\n    },\n\n    stop: function(options) {\n      if(!this._isRunning) {\n        return;\n      }\n\n      this.triggerMethod('before:stop', options);\n\n      this._isRunning = false;\n      this.stopApps();\n\n      this.triggerMethod('stop', options);\n\n      this._stopRunningListeners();\n      this._stopRunningEvents();\n\n    },\n\n    addApp: function(appName, AppDefinition, options) {\n      var app = this._apps[appName] = new AppDefinition(options);\n\n      // When the app is destroyed remove the cached app.\n      app.on('destroy', function() {\n        delete this._apps[appName];\n      }, this);\n\n      if(this._isRunning && app.getOption('startWithParent')) {\n        app.start();\n      }\n\n      return app;\n    },\n\n    getApp: function(appName) {\n      return this._apps[appName];\n    },\n\n    destroyApp: function(app) {\n\n      // if app is a string assume it's an app's name\n      if(_.isString(app)) {\n        app = this.getApp(app);\n      }\n\n      if(app) {\n        app.destroy();\n      }\n    },\n\n    addApps: function(apps) {\n      _.each(apps, function(app, appName) {\n        this.addApp(appName, app);\n      });\n    },\n\n    startApps: function() {\n      _.each(this._apps, function(app) {\n        if(app.getOption('startWithParent')) {\n          app.start();\n        }\n      });\n    },\n\n    stopApps: function() {\n      _.each(this._apps, function(app) {\n        if(app.getOption('stopWithParent')) {\n          app.stop();\n        }\n      });\n    },\n\n    isRunning: function() {\n      return this._isRunning;\n    },\n\n    isDestroyed: function() {\n      return this._isDestroyed;\n    },\n\n    destroy: function() {\n      this.stop();\n\n      this.destroyApps();\n\n      this._isDestroyed = true;\n\n      StateClass.prototype.destroy.apply(this, arguments);\n    },\n\n    _stopRunningEvents: function(){\n      _.each(this._runningEvents, function(args) {\n        this.off.apply(this, args);\n      }, this);\n    },\n\n    _stopRunningListeners: function(){\n      _.each(this._runningListeningTo, function(args) {\n        this.stopListening.apply(this, args);\n      }, this);\n    },\n\n    on: function() {\n      if(this._isRunning) {\n        this._runningEvents = (this._runningEvents || []);\n        this._runningEvents.push(arguments);\n      }\n      return StateClass.prototype.on.apply(this, arguments);\n    },\n\n    listenTo: function() {\n      if(this._isRunning) {\n        this._runningListeningTo = (this._runningListeningTo || []);\n        this._runningListeningTo.push(arguments);\n      }\n      return StateClass.prototype.listenTo.apply(this, arguments);\n    }\n\n  });\n\n  var Component = StateClass.extend({\n    constructor: function(stateAttrs, options){\n      options = options || {};\n      // Make defaults available to this\n      _.extend(this, _.pick(options, ['viewEventPrefix', 'viewClass', 'viewOptions', 'region']));\n\n      Marionette.StateObject.call(this, options);\n\n      this._setStateDefaults(stateAttrs);\n    },\n\n    _shouldDestroy: true,\n\n    _setStateDefaults: function(stateAttrs){\n      _.defaults(stateAttrs, _.result(this, 'defaults'));\n\n      this.setState(stateAttrs, { silent: true });\n    },\n\n    viewEventPrefix: 'view',\n\n    viewClass: Marionette.ItemView,\n\n    viewOptions: {},\n\n    showIn: function(region) {\n      if(region) {\n          this.region = region;\n      }\n\n      this.show();\n    },\n\n    show: function(){\n      if(this._isShown) {\n          throw new Marionette.Error({\n              name: 'ComponentShowError',\n              message: 'Component has already been shown in a region.'\n          });\n      }\n\n      if(!this.region) {\n          throw new Marionette.Error({\n              name: 'ComponentRegionError',\n              message: 'Component has no defined region.'\n          });\n      }\n\n      // Destroy the component if the region is emptied because\n      // it destroys the view\n      this.listenTo(this.region, 'empty', this.destroy);\n\n      this.triggerMethod('before:show');\n\n      this.renderView();\n      this._isShown = true;\n\n      this.triggerMethod('show');\n    },\n\n    renderView: function(){\n      this.view = this.buildView();\n\n      this._proxyViewEvents();\n\n      this.triggerMethod('before:render:view', this.view);\n\n      // _shouldDestroy is flag that prevents the Component from being\n      // destroyed if the region is emptied by Component itself.\n      this._shouldDestroy = false;\n\n      // Show the view in the region\n      this.region.show(this.view);\n\n      this._shouldDestroy = true;\n\n      this.triggerMethod('render:view', this.view);\n    },\n\n    _proxyViewEvents: function(){\n      // Proxies the viewClass's viewEvents to the Component itself\n      // similar to CollectionView childEvents\n      // (http://marionettejs.com/docs/v2.3.2/marionette.collectionview.html#collectionviews-childevents)\n\n      var prefix = this.getOption('viewEventPrefix');\n\n      this.view.on('all', function() {\n        var args = _.toArray(arguments);\n        var rootEvent = args[0];\n\n        args[0] = prefix + ':' + rootEvent;\n        args.splice(1, 0, this.view);\n\n        this.triggerMethod.apply(this, args);\n      }, this);\n    },\n\n    // mixin _state_model from StateObject with any other viewOptions\n    mixinOptions: function(options){\n      return _.extend({ model: this.getState() }, this.viewOptions, options);\n    },\n\n    buildView: function() {\n      return new this.viewClass(this.mixinOptions());\n    },\n\n    _destroy: function(){\n      // apply destroy first for listener cleanup\n      Marionette.StateObject.prototype.destroy.apply(this, arguments);\n\n      this.region.empty();\n    },\n\n    destroy: function(){\n      if(this._shouldDestroy) {\n          this._destroy();\n      }\n\n      return this;\n    }\n  });\n\n  var Toolkit = Marionette.Toolkit = {};\n\n  Toolkit.StateClass = StateClass;\n\n  Toolkit.App = App;\n\n  Toolkit.Component = Component;\n\n}));\n"],"sourceRoot":"/source/"}