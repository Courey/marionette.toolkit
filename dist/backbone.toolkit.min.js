!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b(require("backbone"),require("jquery"),require("backbone.marionette"),require("underscore")):"function"==typeof define&&define.amd?define(["backbone","jquery","backbone.marionette","underscore"],b):a.Toolkit=b(a.Backbone,a.$,a.Marionette,a._)}(this,function(a,b,c,d){"use strict";var e=c.Object.extend({StateModel:a.Model,constructor:function(a){a=a||{};var b=a.StateModel||this.StateModel;this._stateModel=new b,this.bindEntityEvents(this._stateModel,this.getOption("stateEvents")),c.Object.call(this,a)},setState:function(){return this._stateModel.set.apply(this._stateModel,arguments)},getState:function(a){return a?this._stateModel.get.apply(this._stateModel,arguments):this._stateModel},destroy:function(){this._stateModel.stopListening(),c.Object.prototype.destroy.apply(this,arguments)}}),f=e.extend({constructor:function(a){d.bindAll(this,"start","stop"),this._apps={},d.extend(this,d.pick(a,["startWithParent","stopWithParent","apps"])),this.addApps(this.getOption("apps")),this._initializeApps(),e.call(this,a)},_isRunning:!1,_isDestroyed:!1,startWithParent:!1,stopWithParent:!0,_ensureSubappIsIntact:function(){if(this._isDestroyed)throw new c.Error({name:"SubappDestroyedError",message:"Subapp has already been destroyed and cannot be used."})},start:function(a){this._ensureSubappIsIntact(),this._isRunning||(this.triggerMethod("before:start",a),this._isRunning=!0,this.startApps(),this.triggerMethod("start",a))},stop:function(a){this._isRunning&&(this.triggerMethod("before:stop",a),this._isRunning=!1,this.stopApps(),this.triggerMethod("stop",a))},addApp:function(a,b,c){var d=this._apps[a]=new b(c);return this._isRunning&&d.getOption("startWithParent")&&d.start(),d},getApp:function(a){return this._apps[a]},destroyApp:function(a){d.isString(a)&&(a=this.getApp(a)),a&&a.destroy()},addApps:function(a){d.each(a,function(a,b){this.addApp(b,a)})},_initializeApps:function(){},startApps:function(){},stopApps:function(){d.each(this._apps,this.stopApp)},isRunning:function(){return this._isRunning},isDestroyed:function(){return this._isDestroyed},destroy:function(){this.stop(),this.destroyApps(),this._isDestroyed=!0,e.prototype.destroy.apply(this,arguments)}}),g=e.extend({constructor:function(a,b){b=b||{},d.extend(this,d.pick(b,["viewEventPrefix","viewClass","viewOptions","region"])),c.StateObject.call(this,b),this._setStateDefaults(a)},_shouldDestroy:!0,_setStateDefaults:function(a){d.defaults(a,d.result(this,"defaults")),this.setState(a,{silent:!0})},viewEventPrefix:"view",viewClass:c.ItemView,viewOptions:{},showIn:function(a){a&&(this.region=a),this.show()},show:function(){if(this._isShown)throw new c.Error({name:"ComponentShowError",message:"Component has already been shown in a region."});if(!this.region)throw new c.Error({name:"ComponentRegionError",message:"Component has no defined region."});this.listenTo(this.region,"empty",this.destroy),this.triggerMethod("before:show"),this.renderView(),this._isShown=!0,this.triggerMethod("show")},renderView:function(){this.view=this.buildView(),this._proxyViewEvents(),this.triggerMethod("before:render:view",this.view),this._shouldDestroy=!1,this.region.show(this.view),this._shouldDestroy=!0,this.triggerMethod("render:view",this.view)},_proxyViewEvents:function(){var a=this.getOption("viewEventPrefix");this.view.on("all",function(){var b=d.toArray(arguments),c=b[0];b[0]=a+":"+c,b.splice(1,0,this.view),this.triggerMethod.apply(this,b)},this)},mixinOptions:function(a){return d.extend({model:this.getState()},this.viewOptions,a)},buildView:function(){return new this.viewClass(this.mixinOptions())},_destroy:function(){c.StateObject.prototype.destroy.apply(this,arguments),this.region.empty()},destroy:function(){return this._shouldDestroy&&this._destroy(),this}});a.$=b;var h=c.Toolkit={};h.StateClass=e,h.Subapp=f,h.Component=g;var i=h;return i});
//# sourceMappingURL=backbone.toolkit.min.js.map